/**
 * Synchronize.js
 * Compiled on 03.04.2016
 * Version 1.2.5
 *
 *  Copyright (C) 2013-2016 Denis Meyer, calltopower88@googlemail.com
 * All rights reserved.

 * Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
 * 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.

 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
 * THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS
 * BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
 * GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
 * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
!function(a){function b(a){aa&&window.console&&console.log(a)}function c(a,b,c){return!isNaN(a)&&!isNaN(b)&&!isNaN(c)&&c>=b?a>=b&&c>=a:!1}function d(c){return c?f()?videojs(c):a("#"+c):void b("SJS: [getVideoObj] Undefined video element id '"+c+"'")}function e(a){return a?f()?videojs(a):d(a).get(0):void b("SJS: [getVideo] Undefined video element id '"+a+"'")}function f(){return"undefined"!=typeof videojs}function g(a){if(f()&&a){var b=a.id();return""!==b?b:a}return a}function h(a){return F()?ga?(b("SJS: [play] A video is currently buffering"),!1):a?(f()?e(a).paused()&&e(a).ended()||(b("SJS: [play] Playing video element id '"+a+"'"),e(a).play()):(e(a).paused||!e(a).ended)&&(b("SJS: [play] Playing video element id '"+a+"'"),e(a).play()),!0):(b("SJS: [play] Undefined video element id '"+a+"'"),!1):(b("SJS: [play] Not all video IDs are ready, yet"),!1)}function i(a){if(!a)return void b("SJS: [mute] Undefined video element id '"+a+"'");var c=e(a);f()?c.volume()>0&&(b("SJS: [mute] Muting video element id '"+a+"'"),c.volume(0)):c.muted||(b("SJS: [mute] Muting video element id '"+a+"'"),c.muted=!0)}function j(a,c){if(a&&c){b("SJS: [unmute] Unmuting video element id '"+a+"'");var d=e(a);return f()?d.volume(c):(d.muted=!1,d.volume(c)),!0}return b("SJS: [unmute] Undefined video element id '"+a+"'"),!1}function k(a){return a?(b("SJS: [volume] Getting volume from video element id '"+a+"': "+e(a).volume()),e(a).volume()):(b("SJS: [volume] Undefined video element id '"+a+"'"),-1)}function l(a){return a?(b("SJS: [pause] Pausing video element id '"+a+"'"),e(a).pause()):(b("SJS: [pause] Undefined video element id '"+a+"'"),!1)}function m(a){return a?f()?e(a).paused():e(a).paused:(b("SJS: [isPaused] Undefined video element id '"+a+"'"),!1)}function n(a){return a?f()?e(a).duration():e(a).duration:(b("SJS: [getDuration] Undefined video element id '"+a+"'"),-1)}function o(a){return a?f()?e(a).currentTime():e(a).currentTime:(b("SJS: [getCurrentTime] Undefined video element id '"+a+"'"),-1)}function p(a,c){if(a){var d=n(a);return-1!=d&&!isNaN(c)&&c>=0&&d>=c?(f()?e(a).currentTime(c):e(a).currentTime=c,!0):(b("SJS: [setCurrentTime] Could not set time for video element id '"+a+"'"),p(a,d),!1)}return b("SJS: [setCurrentTime] Undefined video element id '"+a+"'"),!1}function q(a){return a?f()?e(a).playbackRate():e(a).playbackRate:(b("SJS: [getPlaybackRate] Undefined video element id '"+a+"'"),1)}function r(a,c){return a?(f()?e(a).playbackRate(c):e(a).playbackRate=c,!0):(b("SJS: [setPlaybackRate] Undefined video element id '"+a+"'"),!1)}function s(a){return a?f()?e(a).buffered():e(a).buffered:void b("SJS: [getBufferTimeRange] Undefined video element id '"+a+"'")}function t(a){var b=o(J),d=o(a);return-1==b||-1==d||c(d,b-S,b)?0:d-b}function u(){ba=[],ca={},da={},ea=0,J=null,fa=0,ga=!1,ha=!1,ia=!1,K=null,ja=!1,ka=!1,la=!1,ma=null,na=1e4,oa=!1,pa=null,qa=[],ra=!1}function v(){if(ba.length<=1)return!1;for(var a=k(J),b=0;b<ba.length;++b)if(ba[b]!==J){d(J).off(),C(b);break}return A(),j(J,a),!0}function w(c){if(b("Unsynchronizing video with id "+c),c===J){var e=d(J);if(e&&(e.off("play"),e.off("pause"),e.off("ratechange"),e.off("ended"),e.off("timeupdate")),!v())return void y()}for(var f=0;f<ba.length;++f)if(ba[f]===c){ba.splice(f,1),a(document).trigger("sjs:idUnregistered",[c]);break}A(),z()}function x(c){b("Adding video with id "+c+" to synchronization");for(var d=0;d<ba.length;++d)if(ba[d]===c)return;ba.push(c),a(document).trigger("sjs:idRegistered",[c]),z()}function y(){b("Unsynchronizing all videos");var a=d(J);a&&(a.off("play"),a.off("pause"),a.off("ratechange"),a.off("ended"),a.off("timeupdate")),u()}function z(){for(var c=0;c<ba.length;++c)if(ba[c]!=J){var d=!1,e=t(ba[c]);if(ra)ra&&(Math.abs(e)>$&&Math.abs(e)>X?d=!0:m(J)||qa[ba[c]]||(b("SJS: [synchronize] Playing video element id '"+ba[c]+"'"),h(ba[c])));else{var f=q(ba[c]),g=q(J);e>Y?Math.abs(e)<T?(a(document).trigger("sjs:synchronizing",[o(J),ba[c]]),f!==g&&(b("SJS: [synchronize] Decreasing playback rate of video element id '"+ba[c]+"' from "+f+" to "+(g+V)),r(ba[c],g+V))):(a(document).trigger("sjs:synchronizing",[o(J),ba[c]]),r(ba[c],q(J)),d=!0):Z>e?Math.abs(e)<T?(a(document).trigger("sjs:synchronizing",[o(J),ba[c]]),f!==g&&(b("SJS: [synchronize] Increasing playback rate of video element id '"+ba[c]+"' from "+f+" to "+(g+U)),r(ba[c],g+U))):(a(document).trigger("sjs:synchronizing",[o(J),ba[c]]),r(ba[c],q(J)),d=!0):m(J)||qa[ba[c]]||(r(ba[c],q(J)),b("SJS: [synchronize] Playing video element id '"+ba[c]+"'"),h(ba[c]))}d&&(a(document).trigger("sjs:synchronizing",[o(J),ba[c]]),b("SJS: [synchronize] Seeking video element id '"+ba[c]+"': "+(o(J)+W)),p(ba[c],o(J)+W)&&(h(ba[c]),m(J)||qa[ba[c]]?(b("SJS: [synchronize] Pausing video element id '"+ba[c]+"' after seeking"),l(ba[c])):(b("SJS: [synchronize] Playing video element id '"+ba[c]+"' after seeking"),h(ba[c]))))}}function A(){if(E()){var c=d(J);ra=0!==a("#"+J+"_flash_api").length,c.on("play",function(){b("SJS: Master received 'play' event"),a(document).trigger("sjs:masterPlay",[o(J)]),la=!1,!ia&&L&&(ia=!0,B());for(var c=0;c<ba.length;++c)ba[c]!=J&&(h(ba[c]),i(ba[c]))}),c.on("pause",function(){b("SJS: Master received 'pause' event"),a(document).trigger("sjs:masterPause",[o(J)]),la=!ka&&ja,ka=ka?!ka:ka;for(var c=0;c<ba.length;++c)ba[c]!=J&&(l(ba[c]),z())}),c.on("ratechange",function(){b("SJS: Master received 'ratechange' event"),a(document).trigger("sjs:masterPlaybackRateChanged",[q(J)]);for(var c=0;c<ba.length;++c)ba[c]!=J&&r(ba[c],q(J))}),c.on("ended",function(){b("SJS: Master received 'ended' event"),a(document).trigger("sjs:masterEnded",[n(J)]),la=!0;for(var c=0;c<ba.length;++c)ba[c]!=J&&(z(),l(ba[c]))}),c.on("timeupdate",function(){a(document).trigger("sjs:masterTimeupdate",[o(J)]),la=!0;var b=Date.now();if(b-Q>R||m(J)){Q=b;for(var c,d=0;d<ba.length;++d)ba[d]!=J&&(i(ba[d]),c=m(ba[d]),z())}})}else for(var e=0;e<ba.length;++e)l(ba[e])}function B(){K=window.setInterval(function(){var b,d=!0;for(b=0;b<ba.length;++b){var e=s(ba[b]);if(e){for(var f=n(ba[b]),g=o(ba[b])+O,i=!1,j=0;j<e.length&&!i;++j)g=g>=f?f:g,c(g,e.start(j),e.end(j)+_)&&(i=!0);d=d&&i,ga=!d}}if(d)ja&&!la?(ja=!1,h(J),la=!1,a(document).trigger("sjs:bufferedAndAutoplaying",[])):ja&&(ja=!1,a(document).trigger("sjs:bufferedButNotAutoplaying",[]));else{for(ja=!0,ka=!0,b=0;b<ba.length;++b)l(ba[b]);la=!1,a(document).trigger("sjs:buffering",[])}},M)}function C(b){ea=b<ba.length?b:0,J=ba[ea],a(document).trigger("sjs:masterSet",[J])}function D(a,c){""!==a?d(a).on("loadeddata",function(){oa=!0,c&&c()}):b("SJS: [doWhenDataLoaded] Undefined video element id '"+a+"'")}function E(){if(f()){for(var a=0;a<ba.length;++a)if(!da[ba[a]])return!1;return!0}return fa==ba.length}function F(){if(f()){for(var a=0;a<ba.length;++a)if(!ca[ba[a]])return!1;return!0}return fa===ba.length}function G(){for(var a=0;a<ba.length;++a)l(ba[a]);ha=!0}function H(){for(var a=0;a<ba.length;++a)l(ba[a]);ha=!1}function I(){null!==ma&&(window.clearInterval(ma),ma=null)}var J,K,L=!0,M=1e3,N=5e3,O=2,P=!0,Q=0,R=1e3,S=1,T=4,U=.5,V=-.5,W=.25,X=W+.05,Y=.05,Z=-.05,$=.05,_=.3,aa=!1,ba=[],ca={},da={},ea=0,fa=0,ga=!1,ha=!1,ia=!1,ja=!1,ka=!1,la=!1,ma=null,na=1e4,oa=!1,pa=null,qa=[],ra=!1;a.synchronizeVideos=function(c,e){var i,j=!0;if(2==arguments.length){var k=a('video[mediagroup="'+e+'"]');for(i=0;i<k.length;++i){var m=ba.length;ba[m]=k[i].getAttribute("id");var n="_html5_api";ba[m]=f()&&-1!=ba[m].indexOf(n)?ba[m].substr(0,ba[m].length-n.length):ba[m],ca[ba[i-1]]=!1,da[ba[i-1]]=!1}}else for(ea=c,i=1;i<arguments.length;++i)j=j&&arguments[i]&&a("#"+arguments[i]).length,j?(ba[ba.length]=arguments[i],ca[ba[i-1]]=!1,da[ba[i-1]]=!1):a(document).trigger("sjs:invalidId",[arguments[i]]);if(j&&ba.length>1){var o;if(f())for(i=0;i<ba.length;++i)a(document).trigger("sjs:idRegistered",[ba[i]]),o=c,d(ba[i]).on("play",G),d(ba[i]).on("pause",H),d(ba[i]).ready(function(){var b=g(this);ca[b]=!0,D(b,function(){if(da[b]=!0,a(document).trigger("sjs:playerLoaded",[b]),E()){C(o);for(var c=0;c<ba.length;++c)d(ba[c]).off("play",G),d(ba[c]).off("pause",H);A(),ha&&h(J),a(document).trigger("sjs:allPlayersReady",[])}}),pa=window.setInterval(function(){if(oa)window.clearInterval(pa),pa=null;else for(var a=0;a<ba.length;++a)d(ba[a]).trigger("loadeddata")},N)});else for(i=0;i<ba.length;++i)a(document).trigger("sjs:idRegistered",[ba[i]]),o=c,d(ba[i]).on("play",G),d(ba[i]).on("pause",H),d(ba[i]).ready(function(){if(++fa,E()){C(o);for(var b=0;b<ba.length;++b)d(ba[b]).off("play",G),d(ba[b]).off("pause",H);A(),ha&&h(J),a(document).trigger("sjs:allPlayersReady",[])}})}else b("SJS: Not enough videos"),a(document).trigger("sjs:notEnoughVideos",[]);P&&a(document).on("sjs:buffering",function(){b("SJS: Received 'sjs:buffering' event"),ma=setInterval(function(){E()&&!la&&h(J)},na)}).on("sjs:bufferedAndAutoplaying",function(){b("SJS: Received 'sjs:bufferedAndAutoplaying' event"),I()}).on("sjs:bufferedButNotAutoplaying",function(){b("SJS: Received 'sjs:bufferedButNotAutoplaying' event"),I()}),a(document).on("sjs:play",function(){b("SJS: Received 'sjs:play' event"),E()&&h(J)}).on("sjs:pause",function(){b("SJS: Received 'sjs:pause' event"),E()&&l(J)}).on("sjs:setCurrentTime",function(a,c){b("SJS: Received 'sjs:setCurrentTime' event"),E()&&p(J,c)}).on("sjs:synchronize",function(){b("SJS: Received 'sjs:synchronize' event"),E()&&z()}).on("sjs:addToSynch",function(a,c){b("SJS: Received 'sjs:addToSynch' event"),c&&x(c)}).on("sjs:removeFromSynch",function(a,c){b("SJS: Received 'sjs:removeFromSynch' event"),c&&w(c)}).on("sjs:unsynchronize",function(){b("SJS: Received 'sjs:unsynchronize' event"),y()}).on("sjs:startBufferChecker",function(){b("SJS: Received 'sjs:startBufferChecker' event"),ia||(window.clearInterval(K),ia=!0,B())}).on("sjs:stopBufferChecker",function(){b("SJS: Received 'sjs:stopBufferChecker' event"),window.clearInterval(K),ia=!1,ga=!1})},a(document).on("sjs:debug",function(a,c){aa=c,b("SJS: Received 'sjs:debug' event")})}(jQuery);