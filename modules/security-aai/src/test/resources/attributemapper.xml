<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:util="http://www.springframework.org/schema/util"
 xsi:schemaLocation="http://www.springframework.org/schema/beans
                    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
                    http://www.springframework.org/schema/util
                    http://www.springframework.org/schema/util/spring-util-2.5.xsd"
 default-autowire="no">

 <util:list id="roleMapping" value-type="java.lang.String">
   <value>'ROLE_AAI_USER'</value>
   <value>'ROLE_AAI_USER_' + ['eduPersonPrincipalName']</value>
   <value>['homeOrganization'] != null ? 'ROLE_AAI_ORG_' + ['homeOrganization'] + '_MEMBER' : null</value>
   <value>['eduPersonEntitlement'].contains('urn:mace:hm.edu:permission:shibboleth:opencast') ? 'ROLE_GROUP_AAI_TRAINER' : null</value>
   <value>['eduPersonPrincipalName'].contains('aaaaa@hm.edu') ? 'ROLE_GROUP_AAI_MANAGER' : null</value>
   <value>['eduPersonPrincipalName'].contains('bbbbb@hm.edu') ? 'ROLE_GROUP_AAI_ACME' : null</value>
   <value>['eduPersonPrincipalName'].contains('ccccc@hm.edu') ? 'ROLE_GROUP_AAI_ACME' : null</value>
   <value>['eduPersonPrincipalName'].contains('ddddd@hm.edu') ? 'ROLE_GROUP_AAI_ACME' : null</value>
   <value>['eduPersonPrincipalName'].contains('eeeee@hm.edu') ? 'ROLE_GROUP_AAI_ACME' : null</value>
   <value>['eduPersonPrincipalName'].contains('fffff@hm.edu') ? 'ROLE_GROUP_AAI_ACME' : null</value>
 </util:list>

 <util:list id="snMapping" value-type="java.lang.String">
   <value>['sn'][0]</value>
 </util:list>

 <util:list id="givenNameMapping" value-type="java.lang.String">
   <value>['givenName'][0]</value>
 </util:list>

 <util:list id="displayNameMapping" value-type="java.lang.String">
   <value>['givenName'][0] + ' ' + ['sn'][0]</value>
 </util:list>

 <util:list id="mailMapping" value-type="java.lang.String">
   <value>['mail'][0]</value>
 </util:list>

 <util:map id="attributeMap" map-class="java.util.HashMap">
   <entry key="roles" value-ref="roleMapping" />
   <entry key="sn" value-ref="snMapping" />
   <entry key="givenName" value-ref="givenNameMapping" />
   <entry key="displayName" value-ref="displayNameMapping" />
   <entry key="mail" value-ref="mailMapping" />
 </util:map>

 <util:list id="roles2Attributes" value-type="java.lang.String">
   <value>['roles']</value>
 </util:list>


 <util:list id="aaiAttributes" value-type="java.lang.String">
   <value>sn</value>
   <value>givenName</value>
   <value>eduPersonEntitlement</value>
   <value>eduPersonPrincipalName</value>
   <value>homeOrganization</value>
 </util:list>

 <bean id="attributeMapper" class="org.opencastproject.security.aai.api.AttributeMapper">
   <property name="useHeader" value="true" />
   <property name="multiValueDelimiter" value=";" />
   <property name="attributeMap" ref="attributeMap" />
   <property name="aaiAttributes" ref="aaiAttributes" />
 </bean>

</beans>