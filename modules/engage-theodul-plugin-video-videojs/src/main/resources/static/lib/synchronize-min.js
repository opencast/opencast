/**
 * Synchronize.js
 * Compiled on 02.05.2016
 * Version 1.2.7
 *
 *  Copyright (C) 2013-2016 Denis Meyer, calltopower88@googlemail.com
 * All rights reserved.

 * Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
 * 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.

 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
 * THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS
 * BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
 * GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
 * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
!function(e){function n(e){de&&window.console&&console.log(e)}function t(e,n,t){return!isNaN(e)&&!isNaN(n)&&!isNaN(t)&&t>=n?e>=n&&t>=e:!1}function i(t){return t?o()?videojs(t):e("#"+t):void n("SJS: [getVideoObj] Undefined video element id '"+t+"'")}function r(e){return e?o()?videojs(e):i(e).get(0):void n("SJS: [getVideo] Undefined video element id '"+e+"'")}function o(){return"undefined"!=typeof videojs}function d(e){if(o()&&e){var n=e.id();return""!==n?n:e}return e}function u(e){return g(e)?C()?le?(n("SJS: [play] A video is currently buffering"),!1):e?(o()?r(e).paused()&&r(e).ended()||(n("SJS: [play] Playing video element id '"+e+"'"),r(e).play()):(r(e).paused||!r(e).ended)&&(n("SJS: [play] Playing video element id '"+e+"'"),r(e).play()),!0):(n("SJS: [play] Undefined video element id '"+e+"'"),!1):(n("SJS: [play] Not all video IDs are ready, yet"),!1):!1}function s(e){if(!e)return void n("SJS: [mute] Undefined video element id '"+e+"'");var t=r(e);o()?t.volume()>0&&(n("SJS: [mute] Muting video element id '"+e+"'"),t.volume(0)):t.muted||(n("SJS: [mute] Muting video element id '"+e+"'"),t.muted=!0)}function a(e,t){if(e&&t){n("SJS: [unmute] Unmuting video element id '"+e+"'");var i=r(e);return o()?i.volume(t):(i.muted=!1,i.volume(t)),!0}return n("SJS: [unmute] Undefined video element id '"+e+"'"),!1}function f(e){return e?(n("SJS: [volume] Getting volume from video element id '"+e+"': "+r(e).volume()),r(e).volume()):(n("SJS: [volume] Undefined video element id '"+e+"'"),-1)}function c(e){return e?(n("SJS: [pause] Pausing video element id '"+e+"'"),r(e).pause()):(n("SJS: [pause] Undefined video element id '"+e+"'"),!1)}function l(e){for(var n=0;n<ue.length;++n)(e&&ue[n]===L||ue[n]!==L)&&c(ue[n])}function g(e){return e?o()?r(e).paused():r(e).paused:(n("SJS: [isPaused] Undefined video element id '"+e+"'"),!1)}function v(e){return e?o()?r(e).duration():r(e).duration:(n("SJS: [getDuration] Undefined video element id '"+e+"'"),-1)}function S(e){return e?o()?r(e).currentTime():r(e).currentTime:(n("SJS: [getCurrentTime] Undefined video element id '"+e+"'"),-1)}function m(e,t){if(e){var i=v(e);return-1!==i&&!isNaN(t)&&t>=0&&i>=t?(o()?r(e).currentTime(t):r(e).currentTime=t,!0):(n("SJS: [setCurrentTime] Could not set time for video element id '"+e+"'"),m(e,i),!1)}return n("SJS: [setCurrentTime] Undefined video element id '"+e+"'"),!1}function h(e){return e?o()?r(e).playbackRate():r(e).playbackRate:(n("SJS: [getPlaybackRate] Undefined video element id '"+e+"'"),1)}function y(e,t){return e?(o()?r(e).playbackRate(t):r(e).playbackRate=t,!0):(n("SJS: [setPlaybackRate] Undefined video element id '"+e+"'"),!1)}function p(e){return e?o()?r(e).buffered():r(e).buffered:void n("SJS: [getBufferTimeRange] Undefined video element id '"+e+"'")}function j(e){var n=S(L),i=S(e);return-1===n||-1===i||t(i,n-X,n)?0:i-n}function J(){ue=[],se={},ae={},fe=0,L=null,ce=0,le=!1,ge=!1,ve=!1,O=null,Se=!1,me=!1,ye=!1,he=!1,pe=null,je=1e4,Je=!1,be=null,Re=[],ze=!1}function b(){if(ue.length<=1)return!1;for(var e=f(L),n=0;n<ue.length;++n)if(ue[n]!==L){i(L).off(),N(n);break}return w(),a(L,e),!0}function R(t){if(n("Unsynchronizing video with id "+t),t===L){var r=i(L);if(r&&(r.off("play"),r.off("pause"),r.off("ratechange"),r.off("ended"),r.off("timeupdate")),!b())return void k()}for(var o=0;o<ue.length;++o)if(ue[o]===t){ue.splice(o,1),e(document).trigger("sjs:idUnregistered",[t]);break}w(),U()}function z(t){n("Adding video with id "+t+" to synchronization");for(var i=0;i<ue.length;++i)if(ue[i]===t)return;ue.push(t),e(document).trigger("sjs:idRegistered",[t]),U()}function k(){n("Unsynchronizing all videos");var e=i(L);e&&(e.off("play"),e.off("pause"),e.off("ratechange"),e.off("ended"),e.off("timeupdate")),J()}function U(){H=Date.now();for(var t=0;t<ue.length;++t)if(ue[t]!==L){var i=!1,r=j(ue[t]);s(ue[t]);var o=g(L);if(o)i=!0;else if(ze)ze&&(Math.abs(r)>re&&Math.abs(r)>ne?i=!0:g(L)||Re[ue[t]]||(n("SJS: [synchronize] Playing video element id '"+ue[t]+"'"),u(ue[t])));else{var d=h(ue[t]),a=h(L);r>te?Math.abs(r)<Y?(e(document).trigger("sjs:synchronizing",[S(L),ue[t]]),d!==a&&(n("SJS: [synchronize] Decreasing playback rate of video element id '"+ue[t]+"' from "+d+" to "+(a+$)),y(ue[t],a+$))):(e(document).trigger("sjs:synchronizing",[S(L),ue[t]]),y(ue[t],h(L)),i=!0):ie>r?Math.abs(r)<Y?(e(document).trigger("sjs:synchronizing",[S(L),ue[t]]),d!==a&&(n("SJS: [synchronize] Increasing playback rate of video element id '"+ue[t]+"' from "+d+" to "+(a+Z)),y(ue[t],a+Z))):(e(document).trigger("sjs:synchronizing",[S(L),ue[t]]),y(ue[t],h(L)),i=!0):g(L)||Re[ue[t]]||(y(ue[t],h(L)),n("SJS: [synchronize] Playing video element id '"+ue[t]+"'"),u(ue[t]))}i&&(e(document).trigger("sjs:synchronizing",[S(L),ue[t]]),o?(n("SJS: [synchronize] Seeking video element id '"+ue[t]+"': "+S(L)),m(ue[t],S(L))&&(n("SJS: [synchronize] Pausing video element id '"+ue[t]+"' after seeking"),c(ue[t]))):(n("SJS: [synchronize] Seeking video element id '"+ue[t]+"': "+(S(L)+ee)),m(ue[t],S(L)+ee)&&(u(ue[t]),Re[ue[t]]||(n("SJS: [synchronize] Playing video element id '"+ue[t]+"' after seeking"),u(ue[t])))))}}function w(){if(A()){var t=i(L);ze=0!==e("#"+L+"_flash_api").length,t.on("play",function(){n("SJS: Master received 'play' event"),e(document).trigger("sjs:masterPlay",[S(L)]),ye=!1,!ve&&x&&(ve=!0,P());for(var t=0;t<ue.length;++t)ue[t]!==L&&(u(ue[t]),s(ue[t]))}),t.on("pause",function(){n("SJS: Master received 'pause' event"),e(document).trigger("sjs:masterPause",[S(L)]),ye=!me,me=!1,l(!0)}),t.on("ratechange",function(){n("SJS: Master received 'ratechange' event"),e(document).trigger("sjs:masterPlaybackRateChanged",[h(L)]);for(var t=0;t<ue.length;++t)ue[t]!==L&&y(ue[t],h(L))}),t.on("ended",function(){n("SJS: Master received 'ended' event"),e(document).trigger("sjs:masterEnded",[v(L)]),ye=!0,l(!1),U()}),t.on("timeupdate",function(){e(document).trigger("sjs:masterTimeupdate",[S(L)]),ye=ye||!g(L),(Date.now()-H>=K||g(L))&&U()})}else l(!0)}function P(){O=window.setInterval(function(){var n,i=!0;for(n=0;n<ue.length;++n){var r=p(ue[n]);if(r){for(var o=v(ue[n]),d=S(ue[n])+W,s=!1,a=0;a<r.length&&!s;++a)d=d>=o?o:d,t(d,r.start(a),r.end(a)+oe)&&(s=!0);i=i&&s,le=!i}}i?Se&&!ye?(Se=!1,u(L),ye=!1,e(document).trigger("sjs:bufferedAndAutoplaying",[])):Se&&(Se=!1,e(document).trigger("sjs:bufferedButNotAutoplaying",[])):(Se=!0,me=!0,l(!0),e(document).trigger("sjs:buffering",[]))},G)}function N(n){fe=n<ue.length?n:0,L=ue[fe],e(document).trigger("sjs:masterSet",[L])}function T(e,t){""!==e?i(e).on("loadeddata",function(){Je=!0,t&&t()}):n("SJS: [doWhenDataLoaded] Undefined video element id '"+e+"'")}function A(){if(o()){for(var e=0;e<ue.length;++e)if(!ae[ue[e]])return!1;return!0}return ce===ue.length}function C(){if(o()){for(var e=0;e<ue.length;++e)if(!se[ue[e]])return!1;return!0}return ce===ue.length}function I(){l(!0),ge=!0}function M(){l(!0),ge=!1}function B(){null!==pe&&(window.clearInterval(pe),pe=null)}function D(n){var t;if(o())for(t=0;t<ue.length;++t)e(document).trigger("sjs:idRegistered",[ue[t]]),i(ue[t]).on("play",I),i(ue[t]).on("pause",M),i(ue[t]).ready(function(){var t=d(this);se[t]=!0,T(t,function(){if(ae[t]=!0,e(document).trigger("sjs:playerLoaded",[t]),A()){N(n);for(var r=0;r<ue.length;++r)i(ue[r]).off("play",I),i(ue[r]).off("pause",M);w(),ge&&u(L),e(document).trigger("sjs:allPlayersReady",[])}}),be=window.setInterval(function(){if(Je)window.clearInterval(be),be=null;else for(var e=0;e<ue.length;++e)i(ue[e]).trigger("loadeddata")},Q)});else for(t=0;t<ue.length;++t)e(document).trigger("sjs:idRegistered",[ue[t]]),i(ue[t]).on("play",I),i(ue[t]).on("pause",M),i(ue[t]).ready(function(){if(++ce,A()){N(n);for(var t=0;t<ue.length;++t)i(ue[t]).off("play",I),i(ue[t]).off("pause",M);w(),ge&&u(L),e(document).trigger("sjs:allPlayersReady",[])}})}function V(){q&&e(document).on("sjs:buffering",function(){n("SJS: Received 'sjs:buffering' event"),pe=setInterval(function(){A()&&!ye&&(ye=!1,u(L),B())},je)}).on("sjs:bufferedAndAutoplaying",function(){n("SJS: Received 'sjs:bufferedAndAutoplaying' event"),B()}).on("sjs:bufferedButNotAutoplaying",function(){n("SJS: Received 'sjs:bufferedButNotAutoplaying' event"),B()})}function _(){e(document).on("sjs:play",function(){n("SJS: Received 'sjs:play' event"),A()&&u(L)}).on("sjs:pause",function(){n("SJS: Received 'sjs:pause' event"),A()&&c(L)}).on("sjs:setCurrentTime",function(e,t){n("SJS: Received 'sjs:setCurrentTime' event"),A()&&m(L,t)}).on("sjs:synchronize",function(){n("SJS: Received 'sjs:synchronize' event"),A()&&U()}).on("sjs:addToSynch",function(e,t){n("SJS: Received 'sjs:addToSynch' event"),t&&z(t)}).on("sjs:removeFromSynch",function(e,t){n("SJS: Received 'sjs:removeFromSynch' event"),t&&R(t)}).on("sjs:unsynchronize",function(){n("SJS: Received 'sjs:unsynchronize' event"),k()}).on("sjs:startBufferChecker",function(){n("SJS: Received 'sjs:startBufferChecker' event"),ve||(window.clearInterval(O),ve=!0,P())}).on("sjs:stopBufferChecker",function(){n("SJS: Received 'sjs:stopBufferChecker' event"),window.clearInterval(O),x=!1,ve=!1,le=!1})}function E(n,t,i){var r,d=!0;if(2===i.length){var u=e('video[mediagroup="'+t+'"]');for(r=0;r<u.length;++r){var s=ue.length;ue[s]=u[r].getAttribute("id");var a="_html5_api";ue[s]=o()&&-1!==ue[s].indexOf(a)?ue[s].substr(0,ue[s].length-a.length):ue[s],se[ue[r-1]]=!1,ae[ue[r-1]]=!1}}else for(fe=n,r=1;r<i.length;++r)d=d&&i[r]&&e("#"+i[r]).length,d?(ue[ue.length]=i[r],se[ue[r-1]]=!1,ae[ue[r-1]]=!1):e(document).trigger("sjs:invalidId",[i[r]]);return d}function F(t,i){var r=E(t,i,arguments);r&&ue.length>1?D(t):(n("SJS: Not enough videos"),e(document).trigger("sjs:notEnoughVideos",[])),V(),_()}var L,O,x=!1,G=1e3,Q=5e3,W=2,q=!0,H=0,K=1e3,X=1,Y=4,Z=.5,$=-.5,ee=.25,ne=ee+.05,te=.05,ie=-.05,re=.05,oe=.3,de=!1,ue=[],se={},ae={},fe=0,ce=0,le=!1,ge=!1,ve=!1,Se=!1,me=!1,he=!1,ye=!1,pe=null,je=1e4,Je=!1,be=null,Re=[],ze=!1;e.synchronizeVideos=F,e(document).on("sjs:debug",function(e,t){de=t,n("SJS: Received 'sjs:debug' event")})}(jQuery);